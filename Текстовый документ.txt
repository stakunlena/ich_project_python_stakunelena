def search_film_by_name(connection, film_name):
    query = """
        SELECT film_id, title, description, release_year
        FROM film
        WHERE CONCAT(' ', title, ' ') LIKE %s
        ORDER BY title
        LIMIT 100;
    """
    param = f"% {film_name} %"
    return query_select(connection, query, (param,))

film_name = input("Введите слово для поиска: ").strip().lower()
data = search_film_by_name(connection, film_name)
print_table_data(data)


cursor.execute('''
SELECT title, length 
FROM film
where length is not null
order by length desc
limit 10''')
# Получаем данные и названия столбцов
data = cursor.fetchall()
kolonki = [i[0] for i in cursor.description]  # Извлечение названий столбцов
# Преобразуем результат в DataFrame
df5 = pd.DataFrame(data, columns=kolonki)
# Выводим первые несколько строк DataFrame
display(df5)


cursor.execute('''
SELECT title, length 
FROM film
where length is not null
order by length desc
limit 10''')
# Получаем данные и названия столбцов
data = cursor.fetchall()
kolonki = [i[0] for i in cursor.description]  # Извлечение названий столбцов
# Преобразуем результат в DataFrame
df5 = pd.DataFrame(data, columns=kolonki)
# Выводим первые несколько строк DataFrame
display(df5)

next10 = 0

Mariia Koshevtsova  кому  Все 12:46 PM
next10 = 0
while next10 < 100:
  query = input("Хотите продолжить? Yes\\No")
  if query == "Yes":
    next10 += 10
    cursor.execute('''
    SELECT title, length
    FROM film
    where length is not null
    order by length desc
    limit 10 offset %s''', (next10,))
  
# Получаем данные и названия столбцов
    data = cursor.fetchall()
    kolonki = [i[0] for i in cursor.description]  # Извлечение названий столбцов
# Преобразуем результат в DataFrame
    df5 = pd.DataFrame(data, columns=kolonki)
# Выводим первые несколько строк DataFrame
    display(df5)
    print(query)
  else:
    break

Mariia Koshevtsova  кому  Все 12:56 PM
cursor.execute('''
    SELECT COUNT(film_id)
    FROM film
    ''')
data = cursor.fetchall()
    #kolonki = [i[0] for i in cursor.description]  # Извлечение названий столбцов
# Преобразуем результат в DataFrame
count_total = int(pd.DataFrame(data)[0][0])
# Выводим первые несколько строк DataFrame
display(count_total)

Mariia Koshevtsova  кому  Все 1:01 PM
next10 = 0
   
while next10 < count_total:
  query = input("Хотите продолжить? Yes\\No ")
  if query == "Yes":
    next10 += 10
    cursor.execute('''
    SELECT title, length
    FROM film
    where length is not null
    order by length desc
    limit 10 offset %s''', (next10,))
  
# Получаем данные и названия столбцов
    data = cursor.fetchall()
    kolonki = [i[0] for i in cursor.description]  # Извлечение названий столбцов
# Преобразуем результат в DataFrame
    df5 = pd.DataFrame(data, columns=kolonki)
# Выводим первые несколько строк DataFrame
    display(df5)
    print(query)
  else:
    break
cursor.execute('''
    SELECT COUNT(film_id)
    FROM film
    ''')
data = cursor.fetchall()
    
# Преобразуем результат в DataFrame
count_total = data[0][0]
# Выводим первые несколько строк DataFrame
display(count_total)

ICH 16  кому  Все 1:04 PM
https://colab.research.google.com/drive/1O2aYPjCuIFqScNKpaRWrI6e1dG0j7Q8t?usp=sharing

ICH 16 1:17 PM
mongodb://ich_editor:verystrongpassword@mongo.edu.itcareerhub.de:27017/?readPreference=primary&ssl=false&authMechanism=DEFAULT&authSource=ich_edit


https://pypi.org/project/prettytable/ для вывода информации в виде таблицы

https://github.com/